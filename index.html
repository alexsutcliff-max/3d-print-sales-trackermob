<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#0b0b0b" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="icon" href="icon-192.png" />
    <title>Print Sales Tracker</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React first -->
    <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel (for JSX in app.js) -->
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>

    <style>
      .safe-bottom { padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 72px); }
      .bottom-bar { height: 64px; padding-bottom: env(safe-area-inset-bottom, 0px); }
    </style>
  </head>
  <body class="bg-gray-100">
    <div id="root" class="safe-bottom">Loading…</div>

    <!-- Recharts with fallback + only boot app after it's loaded -->
    <script>
      (function loadRechartsAndBoot() {
        function injectRecharts(src, onload, onerror) {
          var s = document.createElement('script');
          s.src = src;
          s.onload = onload;
          s.onerror = onerror;
          document.head.appendChild(s);
        }

        function bootApp() {
          if (!window.Recharts) {
            console.error("Recharts still missing; retrying…");
            return setTimeout(bootApp, 300);
          }
          // Now load the app code AFTER Recharts is ready
          var app = document.createElement('script');
          app.type = 'text/babel';
          app.setAttribute('data-presets', 'react,env');
          app.src = 'app.js';
          document.body.appendChild(app);
        }

        // Try jsDelivr first, then unpkg
        injectRecharts(
          'https://cdn.jsdelivr.net/npm/recharts@2.12.6/umd/Recharts.min.js',
          bootApp,
          function () {
            console.warn('jsDelivr failed, trying unpkg…');
            injectRecharts(
              'https://unpkg.com/recharts@2.12.6/umd/Recharts.min.js',
              bootApp,
              function () {
                console.error('Recharts failed to load from both CDNs.');
              }
            );
          }
        );
      })();
    </script>
  </body>
</html>
